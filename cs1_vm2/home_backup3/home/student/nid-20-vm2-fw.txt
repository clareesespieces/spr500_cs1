# Generated by iptables-save v1.8.4 on Fri Oct 23 20:32:21 2020
*filter
:INPUT ACCEPT [63:4798]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [2761:2338677]
:LOGGING - [0:0]
-A INPUT -i lo -j ACCEPT
-A INPUT -s 172.16.0.1/32 -p udp -j ACCEPT
-A INPUT -s 192.168.0.0/16 -p udp -j ACCEPT
-A INPUT -s 172.16.0.1/32 -p icmp -j ACCEPT
-A INPUT -s 192.168.20.0/24 -p icmp -j ACCEPT
-A INPUT -s 192.168.20.1/32 -d 192.168.0.0/16 -p tcp -m tcp --dport 22 -j ACCEPT
-A INPUT -s 172.16.20.1/32 -d 192.168.0.0/16 -p tcp -m tcp --dport 22 -j ACCEPT
-A INPUT -s 10.102.0.0/16 -p tcp -m tcp --dport 22 -j ACCEPT
-A INPUT -p tcp -m tcp --dport 22 -j LOGGING
-A INPUT -s 192.168.20.0/24 -j LOGGING
-A INPUT -j LOGGING
-A LOGGING -p tcp -m limit --limit 2/min -m tcp --dport 22 -j LOG --log-prefix "SSH Access attempts: "
-A LOGGING -p tcp -m tcp --dport 22 -j REJECT --reject-with icmp-port-unreachable
-A LOGGING -s 192.168.20.0/24 -m limit --limit 2/min -j LOG --log-prefix "Private Network Access attemp"
-A LOGGING -j REJECT --reject-with icmp-port-unreachable
-A LOGGING -m limit --limit 2/min -j LOG --log-prefix "Access attempts: "
-A LOGGING -j DROP
COMMIT
# Completed on Fri Oct 23 20:32:21 2020
